<%- include('../layout/header.ejs')%>
  <%- include('../layout/aside.ejs')%>
    <div class="content-wrapper">
      <!-- Content Header (Page header) -->
      <section class="content-header">
        <h1>
          Quản lý danh mục
        </h1>
        <ol class="breadcrumb">
          <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
          <li><a href="#">Examples</a></li>
          <li class="active">Blank page</li>
        </ol>
      </section>

      <!-- Main content -->
      <section class="content">

        <!-- Default box -->
        <div class="box">

          <div class="box-body">


            <form action="/admin/v1/accounts/edit/" method="post">

              <!-- comfirm password -->
              <div class="form-group">
                <label for="exampleInputPassword1">Comfirm Password</label>
                <input name="ConfirmPassWord" type="password" class="form-control" id="exampleInputConfirmPassword1">
              </div>


              <!-- button submit -->
              <button type="submit" class="btn btn-primary btnSubmit"><i class="fa fa-save"></i> Submit</button>
              <a href="/admin/v1/accounts" class="btn btn-default"><i class="fa fa-arrow-left"></i> Trở lại</a>

            </form>

          </div>



        </div>

      </section>

    </div>
    <script>

      // check empty
      const checkEmpty = () => {
        let confirmpassword = document.querySelector("#exampleInputConfirmPassword1")
        if (confirmpassword.value === "") {
          return false
        }
        return true
      }
      

      // function send requird
      const postRequired = async (requestBody) => {
        // Send POST request using Fetch API
        try {
          const response = await fetch(`/admin/v1/accounts/edit/${window.location.href.split("/").reverse()[0]}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(requestBody),
          });

          // Check if the request was successful (status code 2xx)
          if (response.ok) {
            console.log('User created successfully!');
            window.location.href = "http://localhost:8888/admin/v1/accounts";
          } else {
            console.error('Failed to create user:', response.statusText);
          }
        } catch (error) {
          console.error('Error during fetch:', error);
        }
      }


      // btn click
      let btn_submit = document.querySelector(".btnSubmit");
      btn_submit.addEventListener("click", async (e) => {
        e.preventDefault();

        if (checkEmpty() == false) {
          alert("Không để trống thông tin");
        } else {
            const exampleData = {
              ConfirmPassWord: document.querySelector("#exampleInputConfirmPassword1").value,
              userId : decodeURIComponent(`${window.location.href.split("/").reverse()[0]}`)
            };
            await postRequired(exampleData);
            alert("User created successfully!");
            document.querySelector("#exampleInputConfirmPassword1").value = ""
          }
        });
    </script>
    <%- include('../layout/footer.ejs')%>